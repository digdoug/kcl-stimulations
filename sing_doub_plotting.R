Pcsk1_60_train <- test(46.53,173.53,times2,60,55,'test',0.002389883,Pcsk1_60min,'real','60 min train (Pcsk1)','60_min_pcsk1.pdf')
Pcsk1_360_train <- test(46.53,173.53,times2,360,55,'test',0.002389883,Pcsk1,'real','360 min train (Pcsk1)','360_min_psck1.pdf')
# everything that has been trained from 60 and 360 min
# Pcsk1 test
Psck1_5_test <- test(46.53,173.53,times2,5,55,'test',0.002389883,Pcsk1_5min,'real','5 min test (Pcsk1)','5_min_pcsk1.pdf')
Psck1_15_test <- test(46.53,173.53,times2,15,55,'test',0.002389883,Pcsk1_15min,'real','15 min test (Pcsk1)','15_min_pcsk1.pdf')
Psck1_30_test <- test(46.53,173.53,times2,30,55,'test',0.002389883,Pcsk1_30min,'real','30 min test (Pcsk1)','30_min_pcsk1.pdf')
Psck1_120_test <- test(46.53,173.53,times2,120,55,'test',0.002389883,Pcsk1_120min,'real','120 min test (Pcsk1)','120_min_pcsk1.pdf')

# DOUBLE
# Serpinb2
# train 
Serpinb2_60_train <- test(83,208.02,times2,60,55,'test',0.00348018,Serpinb2_60min,'real','60 min train (Serpinb2)','60_min_serpinb2.pdf')
Serpinb2_360_train <- test(83,208.02,times2,360,55,'test',0.00348018,Serpinb2,'real','360 min train (Serpinb2)','360_min_serpinb2.pdf')

# test
Serpinb2_5_train <- test(83,208.02,times2,5,55,'test',0.00348018,Serpinb2_5min,'real','5 min test (Serpinb2)','5_min_serpinb2.pdf')
Serpinb2_15_train <- test(83,208.02,times2,15,55,'test',0.00348018,Serpinb2_15min,'real','15 min test (Serpinb2)','15_min_serpinb2.pdf')
Serpinb2_30_train <- test(83,208.02,times2,30,55,'test',0.00348018,Serpinb2_30min,'real','30 min test (Serpinb2)','30_min_serpinb2.pdf')
Serpinb2_120_train <- test(83,208.02,times2,120,55,'test',0.00348018,Serpinb2_120min,'real','120 min test (Serpinb2)','120_min_serpinb2.pdf')


# SINGLE
Serpinb2_360_train <- test(101.36,163.15,times2,360,55,'test',0.004437315,Serpinb2,'real','360 min train (Serpinb2)','360_min_serpinb2.pdf')
Serpinb2_60_train <- test(101.36,163.15,times2,60,55,'test',0.004437315,Serpinb2_60min,'real','60 min train (Serpinb2)','60_min_serpinb2.pdf')

Serpinb2_5_train <- test(101.36,163.15,times2,5,55,'test',0.004437315,Serpinb2_5min,'real','5 min train (Serpinb2)','5_min_serpinb2.pdf')
Serpinb2_15_train <- test(101.36,163.15,times2,15,55,'test',0.004437315,Serpinb2_15min,'real','15 min train (Serpinb2)','15_min_serpinb2.pdf')
Serpinb2_30_train <- test(101.36,163.15,times2,30,55,'test',0.004437315,Serpinb2_30min,'real','30 min train (Serpinb2)','30_min_serpinb2.pdf')
Serpinb2_120_train <- test(101.36,163.15,times2,120,55,'test',0.004437315,Serpinb2_120min,'real','120 min train (Serpinb2)','120_min_serpinb2.pdf')


# DOUBLE
# Bdnf
# train
Bdnf_60_train <- test(33,277.02,times2,60,55,'test',0.000843481,Bdnf_60min,'real','60 min train (Bdnf)','60_min_bdnf.pdf')
Bdnf_360_train <- test(33,277.02,times2,360,55,'test',0.000843481,Bdnf,'real','360 min train (Bdnf)','360_min_bdnf.pdf')

# test
Bdnf_5_train <- test(33,277.02,times2,5,55,'test',0.000843481,Bdnf_5min,'real','5 min train (Bdnf)','5_min_bdnf.pdf')
Bdnf_15_train <- test(33,277.02,times2,15,55,'test',0.000843481,Bdnf_15min,'real','15 min train (Bdnf)','15_min_bdnf.pdf')
Bdnf_30_train <- test(33,277.02,times2,30,55,'test',0.000843481,Bdnf_30min,'real','30 min train (Bdnf)','30_min_bdnf.pdf')
Bdnf_120_train <- test(33,277.02,times2,120,55,'test',0.000843481,Bdnf_120min,'real','120 min train (Bdnf)','120_min_bdnf.pdf')


# SINGLE
Bdnf_360_train <- test(5,239,times2,360,55,'test',0.000736711,Bdnf,'real','360 min train (Bdnf)','360_min_bdnf.pdf')
Bdnf_60_train <- test(5,239,times2,60,55,'test',0.000736711,Bdnf_60min,'real','60 min train (Bdnf)','60_min_bdnf.pdf')

Bdnf_360_train <- test(5,239,times2,5,55,'test',0.000736711,Bdnf_5min,'real','5 min train (Bdnf)','5_min_bdnf.pdf')
Bdnf_360_train <- test(5,239,times2,15,55,'test',0.000736711,Bdnf_15min,'real','15 min train (Bdnf)','15_min_bdnf.pdf')
Bdnf_360_train <- test(5,239,times2,30,55,'test',0.000736711,Bdnf_30min,'real','30 min train (Bdnf)','30_min_bdnf.pdf')
Bdnf_360_train <- test(5,239,times2,120,55,'test',0.000736711,Bdnf_120min,'real','120 min train (Bdnf)','120_min_bdnf.pdf')


# Fosl2

Fosl2_60_train <- test(49,266.03,times2,60,55,'test',0.00070327,Fosl2_60min,'real','60 min train (Fosl2)','60_min_fosl2.pdf')
Fosl2_360_train <- test(49,266.03,times2,360,55,'test',0.00070327,Fosl2,'real','360 min train (Fosl2)','360_min_fosl2.pdf')

# test

Fosl2_5_train <- test(49,266.03,times2,5,55,'test',0.00070327,Fosl2_5min,'real','5 min train (Fosl2)','5_min_fosl2.pdf')
Fosl2_15_train <- test(49,266.03,times2,15,55,'test',0.00070327,Fosl2_15min,'real','15 min train (Fosl2)','15_min_fosl2.pdf')
Fosl2_30_train <- test(49,266.03,times2,30,55,'test',0.00070327,Fosl2_30min,'real','30 min train (Fosl2)','30_min_fosl2.pdf')
Fosl2_120_train <- test(49,266.03,times2,120,55,'test',0.00070327,Fosl2_120min,'real','120 min train (Fosl2)','120_min_fosl2.pdf')

# DOUBLE
# FOSL2	

Fosl2_360_train <- test(6.44,134.15,times2,360,55,'test',0.001001302,Fosl2,'real','360 min train (Fosl2)','360_min_fosl2.pdf')
Fosl2_60_train <- test(6.44,134.15,times2,60,55,'test',0.001001302,Fosl2_60min,'real','60 min train (Fosl2)','60_min_fosl2.pdf')

Fosl2_5_train <- test(6.44,134.15,times2,5,55,'test',0.001001302,Fosl2_5min,'real','5 min train (Fosl2)','5_min_fosl2.pdf')
Fosl2_15_train <- test(6.44,134.15,times2,15,55,'test',0.001001302,Fosl2_15min,'real','15 min train (Fosl2)','15_min_fosl2.pdf')
Fosl2_30_train <- test(6.44,134.15,times2,30,55,'test',0.001001302,Fosl2_30min,'real','30 min train (Fosl2)','30_min_fosl2.pdf')
Fosl2_120_train <- test(6.44,134.15,times2,120,55,'test',0.001001302,Fosl2_120min,'real','120 min train (Fosl2)','120_min_fosl2.pdf')

# DOUBLE
# PAX1
Pax1_60_train <- test(33.59,243.56,times2,60,55,'test',0.001820363,Pax1_60min,'real','60 min train (Pax1)','60_min_pax1.pdf')
Pax1_360_train <- test(33.59,243.56,times2,360,55,'test',0.001820363,Pax1,'real','360 min train (Pax1)','360_min_pax1.pdf')

# test

Pax1_5_train <- test(33.59,243.56,times2,5,55,'test',0.001820363,Pax1_5min,'real','5 min test (Pax1)','5_min_pax1.pdf')
Pax1_15_train <- test(33.59,243.56,times2,15,55,'test',0.001820363,Pax1_15min,'real','15 min test (Pax1)','15_min_pax1.pdf')
Pax1_30_train <- test(33.59,243.56,times2,30,55,'test',0.001820363,Pax1_30min,'real','30 min test (Pax1)','30_min_pax1.pdf')
Pax1_120_train <- test(33.59,243.56,times2,120,55,'test',0.001820363,Pax1_120min,'real','120 min test (Pax1)','120_min_pax1.pdf')


# SINGLE
# PAX1

Pax1_360_train <- test(15.59,272.28,times2,360,55,'test',0.001628352,Pax1,'real','360 min train (Pax1)','360_min_pax1.pdf')
Pax1_60_train <- test(15.59,272.28,times2,60,55,'test',0.001628352,Pax1_60min,'real','60 min train (Pax1)','60_min_pax1.pdf')

Pax1_360_train <- test(15.59,272.28,times2,5,55,'test',0.001628352,Pax1_5min,'real','5 min train (Pax1)','5_min_pax1.pdf')
Pax1_360_train <- test(15.59,272.28,times2,15,55,'test',0.001628352,Pax1_15min,'real','15 min train (Pax1)','15_min_pax1.pdf')
Pax1_360_train <- test(15.59,272.28,times2,30,55,'test',0.001628352,Pax1_30min,'real','30 min train (Pax1)','30_min_pax1.pdf')
Pax1_360_train <- test(15.59,272.28,times2,120,55,'test',0.001628352,Pax1_120min,'real','120 min train (Pax1)','120_min_pax1.pdf')










# IEG degredation


train <- Pcsk1
train2 <- Pcsk1_60min
train2 <- train2[,-4]
train2
train2$primer <- 'train2'

all_sus <- all_sustain_55mM

colnames(all_sus)
Iegs <- all_sus[all_sus$primer %in% iejs,]

final <- Iegs[Iegs$timepoints == 360,c('primer','mean')]
final$timepoints <- 50
maxx <- ddply(Iegs, .(primer), summarise, mean = max(mean))
maxx$timepoints <- 0

ddply(Iegs, .(primer), summarise, mean = max(mean))

deg <- rbind(maxx,final)
deg <- deg[order(deg$primer),]

ftest <- deg[deg$primer == 'Fos',]
ftest
deg <- deg[deg$primer != 'Fos',]

alpha_max <- read.delim('alpha_max_R.txt')
alpha_max$type <- 'IEG'
alpha_max$meds <- median(alpha_max$alpha)
meds <- data.frame(meds=median(alpha_max$alpha),type='IEG')
 	  
 	  ggplot(alpha_max, aes(x=type,y=alpha)) +
 	     geom_point(position='jitter') +
 	     theme_bw() + 
 	     geom_errorbar(data=meds,aes(x=type,y=meds, ymin=meds, ymax=meds)) +
 	     opts(title= 'Alpha Max')
 	     
 	  ?geom_point
 	  
 	    ggplot(logged,aes(x=timepoints,y=max,colour=primer)) + 
           geom_point() +
           geom_line() +
           scale_x_continuous(breaks=c(0,50),label=c('Max','Final')) +
           xlab('Time Point') +
           ylab('Fold Induction') +          
           opts(title = 'IEG Degradation')    
